<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Assistant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Light theme colors */
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --secondary: #a78bfa;
            --accent: #f97316;
            --accent-light: #fb923c;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --surface: #ffffff;
            --surface-elevated: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --text-inverse: #ffffff;
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --gradient-primary: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --gradient-secondary: linear-gradient(135deg, #a78bfa 0%, #ec4899 100%);
            --gradient-accent: linear-gradient(135deg, #f97316 0%, #f59e0b 100%);
            --gradient-surface: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            --gradient-message: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            --radius-sm: 6px;
            --radius: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
            --transition-fast: 150ms ease;
            --transition: 250ms ease;
            --transition-slow: 350ms ease;
        }

        [data-theme="dark"] {
            /* Dark theme colors */
            --primary: #818cf8;
            --primary-dark: #6366f1;
            --primary-light: #a5b4fc;
            --secondary: #c084fc;
            --accent: #fb923c;
            --accent-light: #fbbf24;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --surface: #1e293b;
            --surface-elevated: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --text-inverse: #0f172a;
            --border: #334155;
            --border-light: #475569;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.25);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
            --gradient-surface: linear-gradient(145deg, #1e293b 0%, #334155 100%);
            --gradient-message: linear-gradient(135deg, #334155 0%, #475569 100%);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f0f4ff;
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Chat Button */
        .chat-button {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 64px;
            height: 64px;
            border-radius: var(--radius-full);
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transition: transform var(--transition), box-shadow var(--transition);
            animation: pulse 2.5s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7);
            }
            70% {
                box-shadow: 0 0 0 12px rgba(99, 102, 241, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0);
            }
        }

        .chat-button:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .chat-button:active {
            transform: translateY(-2px);
        }

        .chat-button i {
            font-size: 24px;
        }

        .chat-button .notification-dot {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 12px;
            height: 12px;
            background: var(--accent);
            border-radius: var(--radius-full);
            border: 2px solid var(--bg-primary);
        }

        /* Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 420px;
            height: 600px;
            max-width: calc(100vw - 48px);
            max-height: calc(100vh - 48px);
            background: var(--surface);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            display: flex;
            flex-direction: column;
            z-index: 1001;
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            overflow: hidden;
        }

        .chat-widget.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            visibility: visible;
        }

        .chat-widget.expanding {
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .chat-widget.expanded {
            width: 800px;
            height: 700px;
        }

        /* Chat Header */
        .chat-header {
            background: var(--gradient-primary);
            color: var(--text-inverse);
            padding: 20px;
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .chat-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 100%);
            pointer-events: none;
        }

        .chat-header-content {
            display: flex;
            align-items: center;
            gap: 16px;
            z-index: 1;
        }

        .chat-avatar {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
            box-shadow: var(--shadow);
        }

        .chat-avatar i {
            font-size: 24px;
        }

        .chat-info h3 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .chat-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            opacity: 0.9;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: var(--radius-full);
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .chat-actions {
            display: flex;
            gap: 8px;
            z-index: 1;
        }

        .chat-action-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-full);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--text-inverse);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition);
            position: relative;
        }

        .chat-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .chat-action-btn.clear-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* Chat Body */
        .chat-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
            background: var(--gradient-surface);
        }

        .chat-body::-webkit-scrollbar {
            width: 6px;
        }

        .chat-body::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-body::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: var(--radius-full);
        }

        .chat-body::-webkit-scrollbar-thumb:hover {
            background: var(--text-tertiary);
        }

        /* Messages */
        .message {
            display: flex;
            gap: 12px;
            max-width: 85%;
            animation: fadeInUp 0.4s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            background: var(--gradient-primary);
            color: var(--text-inverse);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 14px;
            font-weight: 600;
        }

        .message-content {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .message-bubble {
            padding: 12px 16px;
            border-radius: var(--radius-lg);
            background: var(--gradient-message);
            color: var(--text-primary);
            position: relative;
            box-shadow: var(--shadow-sm);
            word-wrap: break-word;
            transition: transform var(--transition);
        }

        .message-bubble:hover {
            transform: translateY(-1px);
        }

        .message.user .message-bubble {
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border-bottom-right-radius: var(--radius-sm);
        }

        .message.bot .message-bubble {
            border-bottom-left-radius: var(--radius-sm);
        }

        .message-time {
            font-size: 12px;
            color: var(--text-tertiary);
            margin: 0 4px;
        }

        .message.user .message-time {
            text-align: right;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 12px;
            max-width: 85%;
            animation: fadeInUp 0.3s ease;
        }

        .typing-indicator .message-avatar {
            width: 32px;
            height: 32px;
        }

        .typing-bubble {
            padding: 12px 16px;
            border-radius: var(--radius-lg);
            background: var(--gradient-message);
            color: var(--text-primary);
            position: relative;
            box-shadow: var(--shadow-sm);
            border-bottom-left-radius: var(--radius-sm);
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: var(--radius-full);
            background: var(--text-tertiary);
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.5;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* Project Card */
        .project-card {
            background: var(--surface-elevated);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all var(--transition);
            cursor: pointer;
            max-width: 85%;
            align-self: flex-start;
        }

        .project-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .project-image {
            height: 160px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .project-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--gradient-primary);
            color: var(--text-inverse);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
        }

        .project-content {
            padding: 16px;
        }

        .project-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .project-description {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .project-tech {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }

        .tech-tag {
            padding: 4px 8px;
            border-radius: var(--radius-sm);
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 500;
        }

        .project-actions {
            display: flex;
            gap: 8px;
        }

        .project-btn {
            padding: 8px 12px;
            border-radius: var(--radius);
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border: none;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .project-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .project-btn.secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        /* Quick Replies */
        .quick-replies {
            padding: 16px 20px;
            background: var(--surface);
            border-top: 1px solid var(--border);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .quick-reply {
            padding: 8px 16px;
            border-radius: var(--radius-full);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition);
        }

        .quick-reply:hover {
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border-color: transparent;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Chat Input */
        .chat-input-container {
            padding: 16px 20px;
            background: var(--surface);
            border-top: 1px solid var(--border);
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .chat-input-wrapper {
            flex: 1;
            position: relative;
        }

        .chat-input {
            width: 100%;
            padding: 12px 16px;
            border-radius: var(--radius-full);
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: all var(--transition);
        }

        .chat-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .chat-input::placeholder {
            color: var(--text-tertiary);
        }

        .chat-send-btn {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition);
        }

        .chat-send-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .chat-send-btn:active {
            transform: translateY(0);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .chat-widget {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 100%;
                border-radius: 0;
                bottom: 0;
                right: 0;
            }

            .chat-widget.expanded {
                width: 100%;
                height: 100%;
            }

            .chat-button {
                bottom: 16px;
                right: 16px;
                width: 56px;
                height: 56px;
            }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Focus styles */
        *:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        button:focus-visible,
        .chat-action-btn:focus-visible,
        .chat-send-btn:focus-visible {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <!-- Chat Button -->
    <button class="chat-button" id="chatButton" aria-label="Open chat">
        <i class="bi bi-chat-dots-fill"></i>
        <span class="notification-dot"></span>
    </button>

    <!-- Chat Widget -->
    <div class="chat-widget" id="chatWidget" role="dialog" aria-labelledby="chat-title" aria-describedby="chat-status">
        <!-- Chat Header -->
        <div class="chat-header">
            <div class="chat-header-content">
                <div class="chat-avatar">
                    <i class="bi bi-person-workspace"></i>
                </div>
                <div class="chat-info">
                    <h3 id="chat-title">Portfolio Assistant</h3>
                    <div class="chat-status" id="chat-status">
                        <span class="status-dot"></span>
                        <span>Online</span>
                    </div>
                </div>
            </div>
            <div class="chat-actions">
                <button class="chat-action-btn clear-btn" id="clearChatBtn" aria-label="Clear chat" title="Clear chat">
                    <i class="bi bi-trash"></i>
                </button>
                <button class="chat-action-btn" id="themeToggleBtn" aria-label="Toggle theme" title="Toggle theme">
                    <i class="bi bi-moon-stars"></i>
                </button>
                <button class="chat-action-btn" id="expandWidgetBtn" aria-label="Expand widget" title="Expand widget">
                    <i class="bi bi-arrows-angle-expand"></i>
                </button>
                <button class="chat-action-btn" id="closeWidgetBtn" aria-label="Close chat" title="Close chat">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
        </div>

        <!-- Chat Body -->
        <div class="chat-body" id="chatBody">
            <!-- Messages will be dynamically added here -->
        </div>

        <!-- Quick Replies -->
        <div class="quick-replies" id="quickReplies">
            <button class="quick-reply" data-message="Tell me about your projects">Projects</button>
            <button class="quick-reply" data-message="What technologies do you use?">Technologies</button>
            <button class="quick-reply" data-message="Tell me about your experience">Experience</button>
            <button class="quick-reply" data-message="How can I contact you?">Contact</button>
        </div>

        <!-- Chat Input -->
        <div class="chat-input-container">
            <div class="chat-input-wrapper">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask about my portfolio..." aria-label="Type your message">
            </div>
            <button class="chat-send-btn" id="sendBtn" aria-label="Send message">
                <i class="bi bi-send-fill"></i>
            </button>
        </div>
    </div>

    <script>
        // DOM Elements
        const chatButton = document.getElementById('chatButton');
        const chatWidget = document.getElementById('chatWidget');
        const chatBody = document.getElementById('chatBody');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const clearChatBtn = document.getElementById('clearChatBtn');
        const themeToggleBtn = document.getElementById('themeToggleBtn');
        const expandWidgetBtn = document.getElementById('expandWidgetBtn');
        const closeWidgetBtn = document.getElementById('closeWidgetBtn');
        const quickReplies = document.getElementById('quickReplies');

        // State
        let chatOpen = false;
        let widgetExpanded = false;
        let currentTheme = localStorage.getItem('chatTheme') || 'light';
        let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];
        let isTyping = false;
        let currentContext = null;

        // Portfolio Data
        const portfolioData = {
            projects: [
                {
                    id: 'project1',
                    title: 'E-Commerce Platform',
                    description: 'A full-stack e-commerce solution with payment integration, inventory management, and real-time analytics.',
                    image: 'https://picsum.photos/seed/ecommerce/600/400.jpg',
                    technologies: ['React', 'Node.js', 'MongoDB', 'Express', 'Stripe API'],
                    link: 'https://github.com/username/ecommerce-platform',
                    featured: true,
                    category: 'Web Development'
                },
                {
                    id: 'project2',
                    title: 'Task Management App',
                    description: 'A collaborative task management application with real-time updates, drag-and-drop functionality, and team collaboration features.',
                    image: 'https://picsum.photos/seed/taskapp/600/400.jpg',
                    technologies: ['Vue.js', 'Firebase', 'Vuex', 'Vuetify'],
                    link: 'https://github.com/username/task-management',
                    featured: true,
                    category: 'Web Application'
                },
                {
                    id: 'project3',
                    title: 'Weather Dashboard',
                    description: 'A responsive weather dashboard with location-based forecasts, interactive maps, and historical data visualization.',
                    image: 'https://picsum.photos/seed/weather/600/400.jpg',
                    technologies: ['JavaScript', 'Chart.js', 'OpenWeather API', 'Bootstrap'],
                    link: 'https://github.com/username/weather-dashboard',
                    featured: false,
                    category: 'Data Visualization'
                }
            ],
            skills: [
                { category: 'Frontend', items: ['React', 'Vue.js', 'JavaScript', 'HTML5', 'CSS3', 'Bootstrap', 'Tailwind CSS'] },
                { category: 'Backend', items: ['Node.js', 'Express', 'MongoDB', 'MySQL', 'Firebase', 'RESTful APIs'] },
                { category: 'Tools', items: ['Git', 'Webpack', 'Docker', 'CI/CD', 'Jest', 'VS Code'] }
            ],
            experience: [
                {
                    title: 'Full Stack Developer',
                    company: 'Tech Solutions Inc.',
                    period: '2020 - Present',
                    description: 'Developed and maintained multiple web applications using modern JavaScript frameworks.'
                },
                {
                    title: 'Frontend Developer',
                    company: 'Digital Agency',
                    period: '2018 - 2020',
                    description: 'Created responsive user interfaces and improved website performance.'
                }
            ],
            contact: {
                email: 'your.email@example.com',
                github: 'https://github.com/yourusername',
                linkedin: 'https://linkedin.com/in/yourprofile',
                portfolio: 'https://yourportfolio.com'
            }
        };

        // AI-like Response Variations
        const responseVariations = {
            greetings: [
                "Hello! ðŸ‘‹ I'm excited to help you explore my portfolio! What would you like to discover today?",
                "Hi there! ðŸŽ‰ Welcome to my portfolio assistant. I'm here to answer any questions about my work!",
                "Greetings! ðŸš€ I'm your personal portfolio guide. Feel free to ask about my projects, skills, or experience!",
                "Hey! ðŸ‘‹ Great to see you here! I can walk you through my portfolio and answer any questions you have."
            ],
            projects: [
                "Let me show you some of my favorite projects! I'm particularly proud of these:",
                "I'd love to share my work with you! Here are some projects that showcase my skills:",
                "Great question! Here are some projects I've worked on that I'm excited to tell you about:",
                "Absolutely! Let me walk you through some of my key projects:"
            ],
            skills: [
                "I work with a diverse tech stack! Here's what I bring to the table:",
                "Technical skills are my passion! Here's my expertise broken down by category:",
                "I've cultivated a strong technical foundation! Here's what I'm proficient in:",
                "My technical toolkit includes these technologies:"
            ],
            experience: [
                "My professional journey has been quite rewarding! Here's my career path:",
                "I've built a solid foundation through these experiences:",
                "Let me share my professional background with you:",
                "My work experience has shaped me into the developer I am today:"
            ],
            contact: [
                "I'd love to connect! Here's how you can reach me:",
                "Let's stay in touch! You can find me at:",
                "I'm always open to new connections! Here are my contact details:",
                "Looking forward to hearing from you! Here's how to get in touch:"
            ],
            thanks: [
                "You're very welcome! ðŸ˜Š Is there anything else about my work you'd like to explore?",
                "My pleasure! ðŸŽ¯ What else would you like to know about my portfolio?",
                "Happy to help! ðŸ’¡ Feel free to ask if you have more questions!",
                "Glad I could assist! ðŸŒŸ What would you like to dive into next?"
            ],
            default: [
                "That's an interesting question! Let me help you with information about my portfolio. What specifically would you like to know?",
                "I'd be happy to help! I can tell you about my projects, skills, experience, or how to contact me. What interests you most?",
                "Great question! I'm here to help you learn about my work. What aspect of my portfolio would you like to explore?",
                "I'm here to assist! Feel free to ask about my projects, technical skills, professional background, or contact information."
            ]
        };

        // Initialize
        function init() {
            // Apply theme to widget only
            chatWidget.setAttribute('data-theme', currentTheme);
            updateThemeIcon();

            // Load chat history
            if (chatHistory.length > 0) {
                renderChatHistory();
            } else {
                // Show welcome message
                setTimeout(() => {
                    const randomGreeting = responseVariations.greetings[Math.floor(Math.random() * responseVariations.greetings.length)];
                    addBotMessage(randomGreeting);
                }, 500);
            }

            // Event listeners
            chatButton.addEventListener('click', toggleChat);
            closeWidgetBtn.addEventListener('click', closeChat);
            sendBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });
            
            // Fixed clear chat button - using a single event listener
            clearChatBtn.addEventListener('click', handleClearChat);
            
            themeToggleBtn.addEventListener('click', toggleTheme);
            expandWidgetBtn.addEventListener('click', toggleWidgetSize);

            // Quick replies
            quickReplies.addEventListener('click', (e) => {
                if (e.target.classList.contains('quick-reply')) {
                    const message = e.target.getAttribute('data-message');
                    addUserMessage(message);
                    handleUserMessage(message);
                }
            });
        }

        // Fixed clear chat handler
        function handleClearChat(e) {
            e.preventDefault();
            e.stopPropagation();
            
            if (confirm('Are you sure you want to clear the chat history?')) {
                // Clear the array
                chatHistory = [];
                
                // Clear localStorage
                localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
                
                // Clear the chat body
                chatBody.innerHTML = '';
                
                // Add confirmation message
                setTimeout(() => {
                    const randomGreeting = responseVariations.greetings[Math.floor(Math.random() * responseVariations.greetings.length)];
                    addBotMessage("Chat history cleared. " + randomGreeting);
                }, 300);
            }
        }

        // Chat Functions
        function toggleChat() {
            chatOpen = !chatOpen;
            if (chatOpen) {
                openChat();
            } else {
                closeChat();
            }
        }

        function openChat() {
            chatWidget.classList.add('active');
            chatOpen = true;
            chatInput.focus();
        }

        function closeChat() {
            chatWidget.classList.remove('active');
            chatOpen = false;
        }

        function toggleWidgetSize() {
            widgetExpanded = !widgetExpanded;
            chatWidget.classList.add('expanding');
            
            setTimeout(() => {
                chatWidget.classList.toggle('expanded');
                expandWidgetBtn.innerHTML = widgetExpanded ? 
                    '<i class="bi bi-arrows-angle-contract"></i>' : 
                    '<i class="bi bi-arrows-angle-expand"></i>';
                chatWidget.classList.remove('expanding');
            }, 50);
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            chatWidget.setAttribute('data-theme', currentTheme);
            localStorage.setItem('chatTheme', currentTheme);
            updateThemeIcon();
        }

        function updateThemeIcon() {
            themeToggleBtn.innerHTML = currentTheme === 'dark' ? 
                '<i class="bi bi-sun"></i>' : 
                '<i class="bi bi-moon-stars"></i>';
        }

        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            addUserMessage(message);
            chatInput.value = '';
            handleUserMessage(message);
        }

        function addUserMessage(text) {
            const message = {
                id: Date.now(),
                text: text,
                sender: 'user',
                time: new Date().toISOString()
            };

            chatHistory.push(message);
            saveChatHistory();
            renderMessage(message);
        }

        function addBotMessage(text, projectCard = null) {
            const message = {
                id: Date.now(),
                text: text,
                sender: 'bot',
                time: new Date().toISOString(),
                projectCard: projectCard
            };

            chatHistory.push(message);
            saveChatHistory();
            renderMessage(message);
        }

        function renderMessage(message) {
            const messageEl = document.createElement('div');
            messageEl.className = `message ${message.sender}`;
            messageEl.innerHTML = `
                <div class="message-avatar">${message.sender === 'user' ? 'U' : 'AI'}</div>
                <div class="message-content">
                    <div class="message-bubble">${message.text}</div>
                    <div class="message-time">${formatTime(message.time)}</div>
                </div>
            `;

            chatBody.appendChild(messageEl);
            chatBody.scrollTop = chatBody.scrollHeight;

            // Render project card if present
            if (message.projectCard) {
                renderProjectCard(message.projectCard);
            }
        }

        function renderProjectCard(project) {
            const projectEl = document.createElement('div');
            projectEl.className = 'project-card';
            projectEl.innerHTML = `
                <div class="project-image" style="background-image: url(${project.image})">
                    <div class="project-badge">${project.category}</div>
                </div>
                <div class="project-content">
                    <h4 class="project-title">${project.title}</h4>
                    <p class="project-description">${project.description}</p>
                    <div class="project-tech">
                        ${project.technologies.map(tech => `<span class="tech-tag">${tech}</span>`).join('')}
                    </div>
                    <div class="project-actions">
                        <button class="project-btn" onclick="window.open('${project.link}', '_blank')">
                            <i class="bi bi-github"></i> View Code
                        </button>
                        <button class="project-btn secondary" onclick="showProjectDetails('${project.id}')">
                            <i class="bi bi-info-circle"></i> Details
                        </button>
                    </div>
                </div>
            `;

            chatBody.appendChild(projectEl);
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function renderChatHistory() {
            chatHistory.forEach(message => {
                renderMessage(message);
            });
        }

        function saveChatHistory() {
            localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        function showTypingIndicator() {
            if (isTyping) return;
            
            isTyping = true;
            const typingEl = document.createElement('div');
            typingEl.className = 'typing-indicator';
            typingEl.id = 'typing-indicator';
            typingEl.innerHTML = `
                <div class="message-avatar">AI</div>
                <div class="typing-bubble">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;

            chatBody.appendChild(typingEl);
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function hideTypingIndicator() {
            isTyping = false;
            const typingEl = document.getElementById('typing-indicator');
            if (typingEl) {
                typingEl.remove();
            }
        }

        function handleUserMessage(message) {
            showTypingIndicator();

            // Simulate processing delay
            setTimeout(() => {
                hideTypingIndicator();
                getLocalResponse(message);
            }, 1000 + Math.random() * 1000); // Random delay for more natural feel
        }

        function getLocalResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Project-related queries - Enhanced with random responses
            if (lowerMessage.includes('project') || lowerMessage.includes('work') || lowerMessage.includes('portfolio')) {
                const randomProjectIntro = responseVariations.projects[Math.floor(Math.random() * responseVariations.projects.length)];
                const featuredProjects = portfolioData.projects.filter(p => p.featured);
                
                addBotMessage(randomProjectIntro);
                
                featuredProjects.forEach(project => {
                    addBotMessage("", project);
                });
                
                const followUps = [
                    "I've worked on several other projects as well. Would you like to know more about any specific technology or aspect of my work?",
                    "These projects represent my best work, but I have others too! Is there a particular technology or feature you're curious about?",
                    "Each project taught me something new! What aspect of these projects interests you most?"
                ];
                const randomFollowUp = followUps[Math.floor(Math.random() * followUps.length)];
                addBotMessage(randomFollowUp);
            }
            // Skills-related queries
            else if (lowerMessage.includes('skill') || lowerMessage.includes('technology') || lowerMessage.includes('tech')) {
                const randomSkillIntro = responseVariations.skills[Math.floor(Math.random() * responseVariations.skills.length)];
                let response = randomSkillIntro + "\n\n";
                
                portfolioData.skills.forEach(skillGroup => {
                    response += `**${skillGroup.category}:** ${skillGroup.items.join(', ')}\n\n`;
                });
                
                const skillFollowUps = [
                    "I'm always learning new technologies. Is there a specific technology you'd like to know more about?",
                    "Technology is constantly evolving! What tech stack are you most interested in?",
                    "I believe in continuous learning! What technologies are you working with?"
                ];
                const randomFollowUp = skillFollowUps[Math.floor(Math.random() * skillFollowUps.length)];
                response += randomFollowUp;
                addBotMessage(response);
            }
            // Experience-related queries
            else if (lowerMessage.includes('experience') || lowerMessage.includes('background') || lowerMessage.includes('history')) {
                const randomExpIntro = responseVariations.experience[Math.floor(Math.random() * responseVariations.experience.length)];
                let response = randomExpIntro + "\n\n";
                
                portfolioData.experience.forEach(exp => {
                    response += `**${exp.title}** at ${exp.company} (${exp.period})\n${exp.description}\n\n`;
                });
                
                const expFollowUps = [
                    "I'm passionate about creating impactful web applications. Would you like to know more about my journey?",
                    "Each role has been a stepping stone! What aspect of my experience interests you most?",
                    "My journey has been incredibly rewarding! What would you like to know about my career path?"
                ];
                const randomFollowUp = expFollowUps[Math.floor(Math.random() * expFollowUps.length)];
                response += randomFollowUp;
                addBotMessage(response);
            }
            // Contact-related queries
            else if (lowerMessage.includes('contact') || lowerMessage.includes('reach') || lowerMessage.includes('email')) {
                const randomContactIntro = responseVariations.contact[Math.floor(Math.random() * responseVariations.contact.length)];
                const response = `${randomContactIntro}\n\nðŸ“§ Email: ${portfolioData.contact.email}\nðŸ”— GitHub: ${portfolioData.contact.github}\nðŸ’¼ LinkedIn: ${portfolioData.contact.linkedin}\nðŸŒ Portfolio: ${portfolioData.contact.portfolio}`;
                addBotMessage(response);
            }
            // Technology-specific queries
            else if (lowerMessage.includes('react') || lowerMessage.includes('vue') || lowerMessage.includes('javascript')) {
                const tech = lowerMessage.includes('react') ? 'React' : 
                            lowerMessage.includes('vue') ? 'Vue.js' : 'JavaScript';
                
                const projectsWithTech = portfolioData.projects.filter(project => 
                    project.technologies.some(t => t.toLowerCase().includes(tech.toLowerCase()))
                );
                
                if (projectsWithTech.length > 0) {
                    const techIntros = [
                        `Great choice! ${tech} is one of my core technologies. Here's where I've used it:`,
                        `I love working with ${tech}! Here are some projects where I've applied it:`,
                        `${tech} has been instrumental in my work! Check out these projects:`
                    ];
                    const randomTechIntro = techIntros[Math.floor(Math.random() * techIntros.length)];
                    
                    addBotMessage(randomTechIntro);
                    
                    projectsWithTech.forEach(project => {
                        addBotMessage("", project);
                    });
                    
                    const techFollowUps = [
                        `${tech} offers so many possibilities! What specific aspect would you like to explore?`,
                        `I'm always excited to talk about ${tech}! What would you like to know?`,
                        `${tech} has been a game-changer for me! How can I help you learn more?`
                    ];
                    const randomFollowUp = techFollowUps[Math.floor(Math.random() * techFollowUps.length)];
                    addBotMessage(randomFollowUp);
                } else {
                    addBotMessage(`I don't have any projects specifically featuring ${tech} in my current portfolio, but I'm always expanding my skillset and would love to work with it in the future!`);
                }
            }
            // Greetings
            else if (lowerMessage.includes('hello') || lowerMessage.includes('hi')) {
                const randomGreeting = responseVariations.greetings[Math.floor(Math.random() * responseVariations.greetings.length)];
                addBotMessage(randomGreeting);
            }
            // Thanks
            else if (lowerMessage.includes('thank')) {
                const randomThanks = responseVariations.thanks[Math.floor(Math.random() * responseVariations.thanks.length)];
                addBotMessage(randomThanks);
            }
            // Default response
            else {
                const randomDefault = responseVariations.default[Math.floor(Math.random() * responseVariations.default.length)];
                addBotMessage(randomDefault);
            }
        }

        function showProjectDetails(projectId) {
            const project = portfolioData.projects.find(p => p.id === projectId);
            if (!project) return;
            
            const details = [
                `**${project.title}** (${project.category})\n\n${project.description}\n\n**Technologies Used:**\n${project.technologies.join(', ')}\n\n**View Code:** ${project.link}`,
                `Here's more about **${project.title}**:\n\n${project.description}\n\n**Tech Stack:** ${project.technologies.join(', ')}\n\n**Check it out:** ${project.link}`,
                `Let me dive deeper into **${project.title}**:\n\n${project.description}\n\n**Built with:** ${project.technologies.join(', ')}\n\n**Source code:** ${project.link}`
            ];
            
            const randomDetail = details[Math.floor(Math.random() * details.length)];
            addBotMessage(randomDetail);
        }

        // Initialize the chat widget
        init();
    </script>
</body>
</html>